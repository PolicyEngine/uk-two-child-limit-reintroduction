<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8"/>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Inter',-apple-system,BlinkMacSystemFont,sans-serif;background:#fff;color:#333;font-size:18px;line-height:1.6;padding:8px 0}
table{width:100%;border-collapse:collapse;margin:8px 0}
th,td{padding:8px 12px;text-align:left;border-bottom:1px solid #e5e7eb}
th{font-weight:600;color:#333}
tr:nth-child(even){background:#f9fafb}
.caption{font-weight:600;margin-top:16px;margin-bottom:4px}
p{margin:8px 0}
</style>
</head>
<body>
<div id="content"></div>
<script>
fetch('./data/headcounts.csv')
.then(r=>r.text())
.then(csv=>{
  const lines=csv.trim().split('\n');
  const headers=lines[0].split(',');
  const rows=lines.slice(1).map(l=>{const c=l.split(',');return{year:c[0],affected_hh:parseFloat(c[2]),affected_ch:parseFloat(c[6]),pct_ch:parseFloat(c[9])}});
  const r0=rows[0];
  const fmtCount=v=>{const abs=Math.abs(v);if(abs>=1e6)return`${Math.round(abs/1e6)} million`;return`${Math.round(abs/1e3)} thousand`};
  const fmtCountShort=v=>{const abs=Math.abs(v);if(abs>=1e6)return`${Math.round(abs/1e6)}m`;return`${Math.round(abs/1e3)}k`};
  const fmtPct=v=>v.toFixed(1);
  let html=`<p>In ${r0.year} reinstating the two child limit would affect ${fmtCount(r0.affected_hh)} households and ${fmtCount(r0.affected_ch)} children, accounting for ${fmtPct(r0.pct_ch)}% of all children.</p>`;
  html+=`<p class="caption">Table 2: Affected households and children</p>`;
  html+=`<table><tr><th>Year</th><th>Affected households</th><th>Affected children</th><th>Share of all children (%)</th></tr>`;
  rows.forEach(r=>{html+=`<tr><td>${r.year}</td><td>${fmtCountShort(r.affected_hh)}</td><td>${fmtCountShort(r.affected_ch)}</td><td>${fmtPct(r.pct_ch)}%</td></tr>`});
  html+=`</table>`;
  document.getElementById('content').innerHTML=html;
});
</script>
</body>
</html>
